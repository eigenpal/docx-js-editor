[2026-02-06 10:30] TASK: 1.1 Cell merge/split via prosemirror-tables
[2026-02-06 10:30] STATUS: starting
[2026-02-06 10:30] NOTES: Created plan file 09_full_ooxml_support.md. Now implementing cell merge/split.
[2026-02-06 10:35] STATUS: editing
[2026-02-06 10:35] NOTES: Imported mergeCells, splitCell, CellSelection from prosemirror-tables into TableExtension.ts
[2026-02-06 10:36] NOTES: Updated getTableContext() to detect CellSelection for hasMultiCellSelection
[2026-02-06 10:36] NOTES: Added mergeCells/splitCell commands to TablePluginExtension
[2026-02-06 10:37] NOTES: Updated commands/table.ts to delegate to real implementations
[2026-02-06 10:37] NOTES: Added mergeCells/splitCell cases to DocxEditor.tsx handleTableAction
[2026-02-06 10:38] STATUS: testing
[2026-02-06 10:38] NOTES: typecheck passed, 32/32 existing table tests pass, 4/4 new merge/split tests pass
[2026-02-06 10:39] STATUS: done

[2026-02-06 10:40] TASK: 1.2 Upgrade cell border model to full BorderSpec
[2026-02-06 10:40] STATUS: starting
[2026-02-06 10:41] STATUS: editing
[2026-02-06 10:41] NOTES: Updated TableCellAttrs in schema/nodes.ts — removed borderColors/borderWidths, borders now {top?: BorderSpec}
[2026-02-06 10:42] NOTES: Updated TableExtension.ts — new buildCellBorderStyles with 31 OOXML→CSS style mappings, updated cell specs, createTable, setTableBorders, setTableBorderColor
[2026-02-06 10:43] NOTES: Simplified toProseDoc.ts — passes through full BorderSpec objects, no more splitting into 3 props
[2026-02-06 10:44] NOTES: Simplified fromProseDoc.ts — direct assignment, removed 50 lines of reconstruction logic
[2026-02-06 10:45] NOTES: Updated layout-bridge/toFlowBlocks.ts — extractCellBorders now reads BorderSpec objects
[2026-02-06 10:46] STATUS: testing
[2026-02-06 10:46] NOTES: typecheck passed, 32/32 table tests pass, 4/4 merge/split tests pass
[2026-02-06 10:46] STATUS: done

[2026-02-06 10:47] TASK: 1.3 Per-cell border editing commands
[2026-02-06 10:47] STATUS: starting
[2026-02-06 10:48] NOTES: Added setCellBorder(side, spec) command to TableExtension.ts
[2026-02-06 10:49] NOTES: Added cellBorder action type to TableAction, per-side border buttons to dropdown
[2026-02-06 10:50] NOTES: Wired borderTop/Bottom/Left/Right + cellBorder action in DocxEditor.tsx
[2026-02-06 10:50] STATUS: done

[2026-02-06 11:00] TASK: 1.4 Vertical alignment + cell margins UI
[2026-02-06 11:00] STATUS: editing
[2026-02-06 11:00] NOTES: Adding margins attr to TableCellAttrs, setCellVerticalAlign + setCellMargins commands, toProseDoc/fromProseDoc conversion, UI controls
[2026-02-06 11:05] NOTES: Added margins attr to schema/nodes.ts, buildCellPaddingStyles in TableExtension.ts
[2026-02-06 11:06] NOTES: Added setCellVerticalAlign + setCellMargins commands + re-exports
[2026-02-06 11:07] NOTES: Updated toProseDoc.ts and fromProseDoc.ts for margin round-trip
[2026-02-06 11:08] NOTES: Added VerticalAlignRow + CellMarginsRow UI in TableOptionsDropdown.tsx
[2026-02-06 11:09] NOTES: Wired cellVerticalAlign + cellMargins actions in DocxEditor.tsx
[2026-02-06 11:10] STATUS: testing
[2026-02-06 11:10] NOTES: typecheck passed, 4/4 merge-split tests pass, 2 pre-existing failures confirmed
[2026-02-06 11:10] STATUS: done

[2026-02-06 11:15] TASK: 1.5 Text direction + no-wrap controls
[2026-02-06 11:15] STATUS: editing
[2026-02-06 11:15] NOTES: Adding textDirection attr, OOXML→CSS mapping, setCellTextDirection + toggleNoWrap commands, UI controls
[2026-02-06 11:20] NOTES: Added textDirection attr to TableCellAttrs, buildTextDirectionStyles OOXML→CSS mapping (tbRl, btLr, rl, tb)
[2026-02-06 11:21] NOTES: Added setCellTextDirection + toggleNoWrap commands, re-exports, UI (TextDirectionRow dropdown, NoWrapRow toggle)
[2026-02-06 11:22] NOTES: Updated toProseDoc/fromProseDoc for textDirection round-trip
[2026-02-06 11:23] STATUS: testing
[2026-02-06 11:23] NOTES: typecheck passed, 4/4 table tests pass
[2026-02-06 11:23] STATUS: done

[2026-02-06 11:25] TASK: 1.6 Row height editing
[2026-02-06 11:25] STATUS: editing
[2026-02-06 11:25] NOTES: Row height attrs + conversion already exist. Adding setRowHeight command and UI
[2026-02-06 11:28] NOTES: Added setRowHeight(height, rule) command, RowHeightRow UI with rule selector + height input
[2026-02-06 11:29] STATUS: testing
[2026-02-06 11:29] NOTES: typecheck passed, 4/4 table tests pass
[2026-02-06 11:29] STATUS: done

[2026-02-06 11:32] TASK: 2.1 Header row repeat toggle
[2026-02-06 11:32] STATUS: editing
[2026-02-06 11:32] NOTES: isHeader already round-trips. Adding toggleHeaderRow command + checkbox UI
[2026-02-06 11:34] NOTES: Added toggleHeaderRow command, HeaderRowRow button in dropdown, wired in DocxEditor
[2026-02-06 11:35] STATUS: testing
[2026-02-06 11:35] NOTES: typecheck passed, 4/4 table tests pass
[2026-02-06 11:35] STATUS: done

[2026-02-06 11:38] TASK: 2.2 Auto-fit + distribute columns evenly
[2026-02-06 11:38] STATUS: editing
[2026-02-06 11:38] NOTES: Adding distributeColumns + autoFitContents commands
[2026-02-06 11:40] NOTES: Added distributeColumns (equal widths) + autoFitContents (remove explicit widths) commands + UI
[2026-02-06 11:41] STATUS: testing
[2026-02-06 11:41] NOTES: typecheck passed, 4/4 table tests pass
[2026-02-06 11:41] STATUS: done

[2026-02-06 11:44] TASK: 2.3 Table properties dialog
[2026-02-06 11:44] STATUS: editing
[2026-02-06 11:44] NOTES: Creating TablePropertiesDialog.tsx with width/alignment/indent/layout controls
[2026-02-06 11:48] NOTES: Created TablePropertiesDialog.tsx, setTableProperties command, wired dialog open/apply
[2026-02-06 11:49] STATUS: testing
[2026-02-06 11:49] NOTES: typecheck passed, 4/4 table tests pass
[2026-02-06 11:49] STATUS: done

[2026-02-06 12:00] TASK: 2.4 Table style gallery
[2026-02-06 12:00] STATUS: starting
[2026-02-06 12:00] NOTES: Research complete. StyleResolver has getStyle() but no getTableStyles(). toProseDoc already resolves conditional formatting. Need: getTableStyles(), applyTableStyle command, TableStyleGallery.tsx component
[2026-02-06 12:02] STATUS: editing
[2026-02-06 12:02] NOTES: Adding getTableStyles() to StyleResolver, predefined table styles, applyTableStyle command
[2026-02-06 12:08] NOTES: Added getTableStyles() to StyleResolver
[2026-02-06 12:09] NOTES: Added applyTableStyle command to TableExtension.ts — walks all cells applying conditional formatting (firstRow/lastRow/banded/firstCol/lastCol/corners)
[2026-02-06 12:10] NOTES: Created TableStyleGallery.tsx with 14 built-in styles, visual previews, support for doc styles
[2026-02-06 12:11] NOTES: Added re-exports through commands/table.ts → commands/index.ts → prosemirror/index.ts
[2026-02-06 12:12] NOTES: Wired gallery in Toolbar.tsx, action handler in DocxEditor.tsx
[2026-02-06 12:13] STATUS: testing
[2026-02-06 12:13] NOTES: typecheck passed, running table tests
[2026-02-06 12:14] NOTES: 4/4 merge-split tests pass, 13/15 scenario table tests pass (2 pre-existing failures)
[2026-02-06 12:14] STATUS: done

[2026-02-06 12:20] TASK: 3.1 Image insert from file
[2026-02-06 12:20] STATUS: starting
[2026-02-06 12:20] NOTES: Research complete. Image nodes already exist with full attrs. Need: insertImage command, file picker UI, media tracking
[2026-02-06 12:22] STATUS: editing
[2026-02-06 12:22] NOTES: Adding onInsertImage prop to Toolbar, image insert button, file picker handler in DocxEditor
[2026-02-06 12:25] NOTES: Added onInsertImage prop to Toolbar, image button in Insert group
[2026-02-06 12:26] NOTES: Added hidden file input + handleInsertImageClick + handleImageFileChange in DocxEditor
[2026-02-06 12:27] NOTES: Image handler reads file as dataURL, gets natural dimensions, constrains to 612px max, inserts PM node
[2026-02-06 12:28] STATUS: testing
[2026-02-06 12:28] NOTES: typecheck passed, 4/4 table tests pass, 26/26 formatting tests pass
[2026-02-06 12:28] STATUS: done

[2026-02-06 12:30] TASK: 3.2 Text wrapping mode selector
[2026-02-06 12:30] STATUS: starting
[2026-02-06 12:30] NOTES: Need setImageWrapType command + floating toolbar on image selection
[2026-02-06 12:35] STATUS: editing
[2026-02-06 12:35] NOTES: Added pmImageContext to state, detecting NodeSelection on image nodes
[2026-02-06 12:36] NOTES: Creating setImageWrapType handler + ImageWrapToolbar UI in Toolbar
[2026-02-06 12:38] NOTES: Added imageContext/onImageWrapType props to Toolbar, 6 wrapping mode buttons
[2026-02-06 12:39] NOTES: handleImageWrapType maps wrap types to displayMode+cssFloat combos
[2026-02-06 12:40] STATUS: testing
[2026-02-06 12:40] NOTES: typecheck passed, 30/30 tests pass (26 formatting + 4 table)
[2026-02-06 12:40] STATUS: done

[2026-02-06 12:45] TASK: 3.3 Image rotation + flip UI
[2026-02-06 12:45] STATUS: editing
[2026-02-06 12:45] NOTES: Adding rotate CW/CCW + flip H/V buttons to image toolbar in Toolbar.tsx
[2026-02-06 12:48] NOTES: Added handleImageTransform handler with rotate/flip logic, parsing current CSS transform
[2026-02-06 12:49] NOTES: Added 4 buttons (rotateCW, rotateCCW, flipH, flipV) to image toolbar section
[2026-02-06 12:50] STATUS: testing
[2026-02-06 12:50] NOTES: typecheck passed, 4/4 table tests pass
[2026-02-06 12:50] STATUS: done

[2026-02-06 12:55] TASK: 3.4 Image positioning dialog
[2026-02-06 12:55] STATUS: editing
[2026-02-06 12:55] NOTES: Creating ImagePositionDialog.tsx with horizontal/vertical alignment, offset, relative-to, and distance-from-text controls
[2026-02-06 13:00] NOTES: Wired dialog in DocxEditor.tsx with imagePositionOpen state, handleOpenImagePosition, handleApplyImagePosition
[2026-02-06 13:01] STATUS: testing
[2026-02-06 13:01] NOTES: typecheck passed, 4/4 table tests pass
[2026-02-06 13:01] STATUS: done

[2026-02-06 13:02] TASK: 3.5 Image alt text + border/outline
[2026-02-06 13:02] STATUS: starting
[2026-02-06 13:02] NOTES: Need to add alt text editor in image properties, border style/color/width as CSS + a:ln serialization
[2026-02-06 13:05] STATUS: editing
[2026-02-06 13:05] NOTES: Adding borderWidth/borderColor/borderStyle attrs to ImageAttrs + ImageExtension, creating ImagePropertiesDialog
[2026-02-06 13:10] NOTES: Added border attrs to ImageAttrs, ImageExtension (parseDOM/toDOM with CSS border rendering)
[2026-02-06 13:11] NOTES: Created ImagePropertiesDialog.tsx with alt text textarea + border width/style/color + preview
[2026-02-06 13:12] NOTES: Added imagePropsOpen state, handleOpenImageProperties, handleApplyImageProperties to DocxEditor
[2026-02-06 13:13] NOTES: Added outline field to Image type, border parsing in toProseDoc, round-trip in fromProseDoc
[2026-02-06 13:14] NOTES: Added "Properties" button (tune icon) to Toolbar image section
[2026-02-06 13:15] STATUS: testing
[2026-02-06 13:15] NOTES: typecheck passed, 30/31 tests pass (1 pre-existing skip)
[2026-02-06 13:15] STATUS: done
